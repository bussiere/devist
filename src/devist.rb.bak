class Marray < Array
    def [](i)
        super.nil? ? self[i] = Marray.new : super
    end
end

require './Model/version.rb'

def extract_version (line)
  line[/n (.*) of/, 1]
end

def extract_change (line)
  line.split(': ')[-1]
end

def iretate_changelog (ary)

end

def parse_changelog (file_name)
  d_log = []


  version = -1 
  added = 0

  File.foreach(file_name) do |line|

    case line
      when /### Version.+/
        version+=1
        d_log[version] = Version.new(extract_version(line))
        next

      when /#added.+/
        d_log[version].tag 'added', extract_change(line)
        next

      when /#fixed.+/
        d_log[version].tag 'fixed', extract_change(line)
        next

      when /#removed.+/
        d_log[version].tag 'removed', extract_change(line)
        next

      when /#improved.+/
        d_log[version].tag 'improved', extract_change(line)
        next
    end

  end

  p d_log  
  p

end

p Dir.pwd
parse_changelog(Dir.pwd + "/TEST.md")

#extract_version("### Version 1.0.0 of Apr 24 2017")
